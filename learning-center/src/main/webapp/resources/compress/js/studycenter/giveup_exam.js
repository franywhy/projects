window.pageScript=(new function(){var n=this;n.classType="",n.userPlanId="",n.course="",n.courseId="",n.provinceId="",n.timeId="",n.cause="",n.businessId=pageParam.businessId,n.attendanceId=null,this.init=function(){return n.bindEvent(),n},this.bindEvent=function(){$("#applyBtn").click(function(){$("#attFormLayer .mask-layer").show(300)}),$("#attFormLayer .grey-close-p").click(function(){$("#attFormLayer .mask-layer").hide(300)}),$("#classType").click(function(){n.sliderAction($(this))}),$("#course").click(function(){if(""==$.trim($("#classType input").val()))return $("#promptText .text-se").text("请先选择班型"),$("#promptText").css("display","inline-block"),!1;n.sliderAction($(this))}),$("#province").click(function(){n.sliderAction($(this))}),$("#time").click(function(){n.sliderAction($(this))}),$("#selectList > .select-list").click(function(){var t=$(this).text();$(this).parent().parent().find("input").val(t),n.userPlanId=$(this).attr("data-id"),$(this).parent().slideUp(),$(this).parent().parent().find("input").css("background","#fff"),n.getCourseList()}),$("#selectList3 > .select-list").click(function(){var t=$(this).text();$(this).parent().parent().find("input").val(t),n.provinceId=$(this).attr("data-id"),$(this).parent().slideUp(),$(this).parent().parent().find("input").css("background","#fff")}),$("#selectList4 > .select-list").click(function(){var t=$(this).text();$(this).parent().parent().find("input").val(t),n.timeId=$(this).attr("data-id"),$(this).parent().slideUp(),$(this).parent().parent().find("input").css("background","#fff")}),$("#cancelBtn,#cancelConfirmLayer .grey-close-p").click(function(){$("#cancelConfirmLayer .mask-layer").hide(300)}),$("#confirmBtn").click(function(){n.cancelRequset()}),$("#form").submit(function(){return n.checkForm()&&n.submitForm(),!1})},this.getCourseList=function(){hqTool.showLoad(n.businessId),$.ajax({url:"/learningCenter/web/courseAbnormalAbandonExam/courseListByOrderId",type:"GET",async:!0,data:{orderId:n.userPlanId},dataType:"json",success:function(t){if(hqTool.hideLoad(),200!=t.code)return alert(t.message),!1;if($("#course input").val(""),$("#selectList2").empty(),null!=t.data)for(var e=0;e<t.data.length;e++)$("#selectList2").append('<div class="select-list" data-id="'+t.data[e].courseId+'" onclick="pageScript.selectList($(this))">'+t.data[e].courseName+"</div>");return!1}})},this.checkForm=function(){return n.classType=$.trim($("#classType input").val()),n.course=$.trim($("#course input").val()),n.province=$.trim($("#province input").val()),n.time=$.trim($("#time input").val()),n.cause=$.trim($("#cause textarea").val()),""==n.classType?($("#promptText .text-se").text("请输入完整的弃考申请内容，不能有为空项。"),$("#promptText").css("display","inline-block"),!1):""==n.course?($("#promptText .text-se").text("请输入完整的弃考申请内容，不能有为空项。"),$("#promptText").css("display","inline-block"),!1):""==n.province?($("#promptText .text-se").text("请输入完整的弃考申请内容，不能有为空项。"),$("#promptText").css("display","inline-block"),!1):""==n.time?($("#promptText .text-se").text("请输入完整的弃考申请内容，不能有为空项。"),$("#promptText").css("display","inline-block"),!1):""!=n.cause||($("#promptText .text-se").text("请输入完整的弃考申请内容，不能有为空项。"),$("#promptText").css("display","inline-block"),!1)},this.submitForm=function(){hqTool.showLoad(n.businessId),$.ajax({url:"/learningCenter/web/courseAbnormalAbandonExam/save",type:"GET",async:!0,data:{orderId:n.userPlanId,courseId:n.courseId,bkAreaId:n.provinceId,scheduleId:n.timeId,abnormalReason:n.cause},dataType:"json",success:function(t){return hqTool.hideLoad(),$("#promptText").hide(),200==t.code?window.location.reload():alert(t.message),!1}})},this.cancel=function(t){n.attendanceId=t,$("#cancelConfirmLayer .mask-layer").show(300)},this.cancelRequset=function(){if(null==n.attendanceId)return!1;hqTool.showLoad(n.businessId),$.ajax({url:"/learningCenter/web/courseAbnormalAbandonExam/updateCancel",type:"GET",async:!0,data:{id:n.attendanceId},dataType:"json",success:function(t){return hqTool.hideLoad(),200==t.code?window.location.reload():alert(t.message),!1}})},this.sliderAction=function(t){$(".select-bar .select").slideUp(),$(".select-bar input").css("background","#fff"),t.parent().find(".select").is(":hidden")&&(t.parent().find("input").css("background","#e6e6e6"),t.parent().find(".select").slideDown())},this.selectList=function(t){var e=t.text();t.parent().parent().find("input").val(e),n.courseId=t.attr("data-id"),t.parent().slideUp(),t.parent().parent().find("input").css("background","#fff"),$("#promptText").hide()}}).init();